const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/DistributionChart-wh40PKkL.js","assets/index-4vDheKbt.js","assets/index-BlnMaqU-.css","assets/DistributionChart-91z5xMqA.css"])))=>i.map(i=>d[i]);
import{s as T,x as $,r as u,o as j,b as l,e as t,h as c,t as i,g as o,y as I,q as H,l as y,S as U,F as w,k as D,m as z,u as G,d as s,i as J,j as K,_ as Q}from"./index-4vDheKbt.js";import{c as W,d as X,e as Y}from"./useStats-CSNqs6-Y.js";const Z={class:"min-h-screen q-page pt-24 md:pt-28"},ee={class:"max-w-6xl mx-auto p-6 space-y-10"},te={class:"flex items-center justify-between"},se={class:"q-muted"},le={class:"flex items-center gap-3"},ae={class:"grid grid-cols-1 gap-8"},oe={class:"q-card p-5"},ne={key:0,class:"q-muted"},ie={class:"q-card p-6"},re={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},de=["value"],ue=["value"],ce=["value"],pe=["value"],ve={class:"mt-2 flex flex-wrap gap-2"},me={key:0,class:"q-muted"},fe={class:"md:col-span-2"},be={class:"mt-2 flex flex-wrap gap-2"},_e={key:0,class:"q-muted"},xe={key:0,class:"p-4 rounded q-card"},ge={__name:"StatsPage",setup(he){const C=K(()=>Q(()=>import("./DistributionChart-wh40PKkL.js"),__vite__mapDeps([0,1,2,3]))),S=$(),_=G(),r=S.params.shortCode,p=`${location.origin}/${r}`,{copy:V}=W(),{data:R,error:P,refresh:A}=X(r),{data:B,loading:F,error:N,refresh:O}=Y(r),v=R,m=u([]),f=u([]),b=u([]),d=u(""),k=F;function E(n){try{return new Date(n).toLocaleString()}catch{return String(n)}}async function x(){d.value="",await Promise.all([A(),O()]),(P.value||N.value)&&(d.value="短链不存在或无权查看");const n=B.value||{};m.value=(n.device||[]).map(e=>({label:e.label||e.name||e.key||e.device||"未知",value:e.value||e.count||0})),f.value=(n.city||[]).slice(0,5).map(e=>({label:e.city||e.label||e.name||"未知",value:e.count||e.value||0})),b.value=(n.referer||[]).map(e=>({label:e.referer||e.label||e.name||"未知",value:e.count||e.value||0}))}function L(){_.push("/")}function M(){_.push("/dashboard")}return j(x),(n,e)=>{var g,h,q;return s(),l("div",Z,[t("div",ee,[t("div",te,[t("div",se,"首页 / 统计看板 / "+i(o(r)),1),t("div",le,[t("button",{onClick:L,class:"q-btn-ghost px-3 py-1"},"返回首页"),t("button",{onClick:M,class:"q-btn-ghost px-3 py-1"},"返回看板"),t("a",{href:p,onClick:e[0]||(e[0]=I(a=>o(V)(p),["prevent"])),class:"q-btn-ghost px-3 py-1"},"复制短链")])]),t("div",ae,[t("div",oe,[e[2]||(e[2]=t("div",{class:"q-card-title mb-3"},"来源渠道占比（饼图）",-1)),(s(),H(U,null,{fallback:y(()=>[...e[1]||(e[1]=[t("div",{class:"h-[240px] q-card"},null,-1)])]),default:y(()=>[J(o(C),{type:"pie",data:b.value,engine:"echarts"},null,8,["data"])]),_:1})),!b.value.length&&!o(k)?(s(),l("div",ne,"暂无数据")):c("",!0)])]),t("div",ie,[e[10]||(e[10]=t("div",{class:"q-card-title mb-4"},"详细统计数据",-1)),t("div",re,[t("div",null,[e[3]||(e[3]=t("label",{class:"q-muted text-[13px]"},"短码",-1)),t("input",{class:"q-input mt-1 w-full",value:o(r),readonly:"",disabled:""},null,8,de)]),t("div",null,[e[4]||(e[4]=t("label",{class:"q-muted text-[13px]"},"短链",-1)),t("input",{class:"q-input mt-1 w-full",value:p,readonly:"",disabled:""})]),t("div",null,[e[5]||(e[5]=t("label",{class:"q-muted text-[13px]"},"总访问量",-1)),t("input",{class:"q-input mt-1 w-full",value:((g=o(v))==null?void 0:g.totalVisits)??"-",readonly:"",disabled:""},null,8,ue)]),t("div",null,[e[6]||(e[6]=t("label",{class:"q-muted text-[13px]"},"今日访问量",-1)),t("input",{class:"q-input mt-1 w-full",value:((h=o(v))==null?void 0:h.todayVisits)??"-",readonly:"",disabled:""},null,8,ce)]),t("div",null,[e[7]||(e[7]=t("label",{class:"q-muted text-[13px]"},"创建时间",-1)),t("input",{class:"q-input mt-1 w-full",value:E((q=o(v))==null?void 0:q.createdAt),readonly:"",disabled:""},null,8,pe)]),t("div",null,[e[8]||(e[8]=t("label",{class:"q-muted text-[13px]"},"Top 城市",-1)),t("div",ve,[(s(!0),l(w,null,D(f.value,a=>(s(),l("span",{key:a.label,class:"q-chip"},i(a.label)+"（"+i(a.value)+"）",1))),128)),f.value.length?c("",!0):(s(),l("span",me,"暂无数据"))])]),t("div",fe,[e[9]||(e[9]=t("label",{class:"q-muted text-[13px]"},"设备分布",-1)),t("div",be,[(s(!0),l(w,null,D(m.value,a=>(s(),l("span",{key:a.label,class:"q-chip"},i(a.label)+"（"+i(a.value)+"）",1))),128)),m.value.length?c("",!0):(s(),l("span",_e,"暂无数据"))])])])]),d.value?(s(),l("div",xe,[z(i(d.value)+" ",1),t("button",{class:"ml-3 q-btn-ghost px-3 py-1",onClick:x},"重试")])):c("",!0)])])}}},we=T(ge,[["__scopeId","data-v-fea49dec"]]);export{we as default};
